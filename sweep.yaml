# sweep.yaml

method: bayes
metric:
  name: "moving_avg/throughput"
  goal: maximize

parameters:
  learning_rate:
    distribution: log_uniform_values
    min: 5e-5
    max: 1e-3

  gamma:
    distribution: uniform
    min: 0.95
    max: 0.999

  gae_lambda:
    distribution: uniform
    min: 0.8
    max: 0.975

  clip_coef:
    distribution: uniform
    min: 0.1
    max: 0.4

  ent_coef:
    distribution: log_uniform_values
    min: 1e-4
    max: 1e-2

  vf_coef:
    distribution: uniform
    min: 0.5
    max: 0.9

  max_grad_norm:
    distribution: uniform
    min: 0.75
    max: 2.5

  chan1:
    values: [16, 32, 48, 64, 96]

  chan2:
    values: [32, 48, 64, 96]

  chan3:
    values: [32, 48, 64, 96, 128]

  flat_dim:
    values: [64, 128, 256, 512, 1024]

  adam_epsilon:
    distribution: log_uniform_values
    min: 1e-6
    max: 1e-3

early_terminate:
  type: hyperband
  min_iter: 150_000 # gsteps
  eta: 2
  s: 3

program: ppo.py

command:
  - bash
  - run_sweep.sh
  - --total-timesteps
  - 100_000 # timesteps
  - --track
  - ${args}
